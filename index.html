<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RLUSD Supply Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #supplyChart { max-width: 800px; margin-bottom: 20px; }
        table { border-collapse: collapse; width: 100%; max-width: 800px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h1>RLUSD Total Supply (Last 30 Days)</h1>
    <canvas id="supplyChart"></canvas>
    <h2>Supply Change Log</h2>
    <table id="changeLog">
        <thead>
            <tr>
                <th>Date</th>
                <th>Quantity Added</th>
                <th>Total Supply</th>
            </tr>
        </thead>
        <tbody id="logBody"></tbody>
    </table>

    <script>
        // Load data from data.json (updated daily by GitHub Actions)
        fetch('data.json')
            .then(response => response.json())
            .then(supplyData => {
                // Chart setup
                const ctx = document.getElementById('supplyChart').getContext('2d');
                const chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: supplyData.map(d => d.date),
                        datasets: [{
                            label: 'RLUSD Total Supply',
                            data: supplyData.map(d => d.supply),
                            borderColor: 'blue',
                            fill: false
                        }]
                    },
                    options: {
                        scales: {
                            x: { title: { display: true, text: 'Date' } },
                            y: { title: { display: true, text: 'Total Supply' } }
                        }
                    }
                });

                // Log setup
                const logBody = document.getElementById('logBody');
                let lastSupply = supplyData[0].supply;
                supplyData.slice(1).forEach(entry => {
                    const change = entry.supply - lastSupply;
                    if (change !== 0) {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${entry.date}</td>
                            <td>${change > 0 ? '+' : ''}${change.toFixed(2)}</td>
                            <td>${entry.supply.toFixed(2)}</td>
                        `;
                        logBody.appendChild(row);
                    }
                    lastSupply = entry.supply;
                });
            })
            .catch(error => console.error('Error loading data:', error));
    </script>
</body>
</html>